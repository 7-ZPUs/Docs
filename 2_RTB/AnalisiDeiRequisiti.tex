\documentclass[a4paper,12pt]{article}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[italian, provide=*]{babel}
\usepackage[sfdefault]{atkinson}
\renewcommand*\familydefault{\sfdefault}
\usepackage{float}
\usepackage{microtype}
\usepackage{geometry}
\usepackage{setspace}
\usepackage{enumitem}
\usepackage{titlesec}
\usepackage{chngpage}
\usepackage{tocloft}
\usepackage{longtable}
\usepackage{array}
\usepackage{graphicx}
\usepackage{fancyhdr}
\usepackage{xcolor}
\usepackage{color,soul}
\usepackage[most]{tcolorbox}
\usepackage{nameref}
\usepackage[colorlinks=true]{hyperref}

\hypersetup{
    linkcolor=black,
    urlcolor=blue
}

\definecolor{lightblack}{gray}{0.35}
\newcommand{\glossario}[1]{\textit{#1}\textsubscript{\textbf{\textit{\textcolor{lightblack}{G}}}}}
\newcommand{\ped}[1]{\textsubscript{#1}}

\pagestyle{fancy}
\setlength{\headwidth}{\textwidth}
\fancyhfoffset[L,R]{0pt}
\lhead{\rightmark}
\rhead{7-ZPUs}
\lfoot{Analisi dei requisiti}
\rfoot{\thepage}
\cfoot{}
\renewcommand{\headrulewidth}{0.8pt}
\renewcommand{\footrulewidth}{0.8pt}

\renewcommand{\contentsname}{Indice}
\renewcommand{\listoftables}{Elenco delle tabelle}
\renewcommand{\listoffigures}{Elenco delle immagini}
\geometry{margin=2.5cm}
\usepackage{titlesec}
\setcounter{tocdepth}{5}
\setcounter{secnumdepth}{5}


\titleformat{\section}{\LARGE\bfseries}{\thesection}{1em}{}
\titleformat{\subsection}{\Large\bfseries}{\thesubsection}{1em}{}
\titleformat{\subsubsection}{\large\bfseries}{}{1em}{}
\titleformat{\subsubsubsection}{\normalsize\bfseries}{}{1em}{}
\titleformat{\paragraph}{\large\bfseries}{}{1em}{}
\titleformat{\subparagraph}{\normalsize\bfseries}{}{1em}{}

% --- INIZIO DEFINIZIONE CONTATORI UC ---

% 1. Contatore Principale (es. UC-1)
\newcounter{ucMain}
\newcommand{\usecase}[2]{% #1=Label (opzionale), #2=Titolo
    \refstepcounter{ucMain}%
    \setcounter{ucSub}{0}% Reset sotto-contatori
    \setcounter{ucVar}{0}%
    \subsubsection*{UC-\theucMain\ - #2}%
    \addcontentsline{toc}{subsubsection}{UC-\theucMain\ - #2}%
    \ifx&#1&%
    \else\label{#1}\fi%
}

% 2. Contatore Varianti (es. UC-2a, UC-2b)
\newcounter{ucVar}[ucMain]
\renewcommand{\theucVar}{\alph{ucVar}} % Usa lettere a, b, c...
\newcommand{\varusecase}[2]{%
    \refstepcounter{ucVar}%
    \subsubsection*{UC-\theucMain\theucVar\ - #2}%
    \addcontentsline{toc}{subsubsection}{UC-\theucMain\theucVar\ - #2}%
    \ifx&#1&%
    \else\label{#1}\fi%
}
% 1. Contatore Figlio di Variante (es. UC-3c.1)
\newcounter{varSub}[ucVar]
\newcommand{\varsubusecase}[2]{%
    \refstepcounter{varSub}%
    \setcounter{varSubSub}{0}% Reset del livello successivo
    \subsubsection*{UC-\theucMain\theucVar.\thevarSub\ - #2}%
    \addcontentsline{toc}{subsubsection}{UC-\theucMain\theucVar.\thevarSub\ - #2}%
    \ifx&#1&%
    \else\label{#1}\fi%
}

% 2. Contatore Nipote di Variante (es. UC-3c.1.3)
% Si resetta ogni volta che cambia il sotto-livello variante (varSub)
\newcounter{varSubSub}[varSub]
\newcommand{\varsubsubusecase}[2]{%
    \refstepcounter{varSubSub}%
    \paragraph*{UC-\theucMain\theucVar.\thevarSub.\thevarSubSub\ - #2}%
    \addcontentsline{toc}{paragraph}{UC-\theucMain\theucVar.\thevarSub.\thevarSubSub\ - #2}%
    \ifx&#1&%
    \else\label{#1}\fi%
}

% 3. Livello di profondità variante (es. UC-3c.1.1.1)
\newcounter{varDeep}[varSubSub]
\newcommand{\vardeepusecase}[2]{%
    \refstepcounter{varDeep}%
    \paragraph*{UC-\theucMain\theucVar.\thevarSub.\thevarSubSub\.\thevarDeep - #2}%
    \addcontentsline{toc}{paragraph}{UC-\theucMain\theucVar.\thevarSub.\thevarSubSub\.\thevarDeep - #2}%
    \ifx&#1&%
    \else\label{#1}\fi%
}

% 4. Livello massimo di profondità variante (es. UC-3c.1.1.1.1)
% Reset su varDeep
\newcounter{varSubDeep}[varDeep]
\newcommand{\varsubdeepusecase}[2]{%
    \refstepcounter{varSubDeep}%
    \paragraph*{UC-\theucMain\theucVar.\thevarSub.\thevarSubSub.\thevarDeep.\thevarSubDeep\ - #2}%
    \addcontentsline{toc}{paragraph}{UC-\theucMain\theucVar.\thevarSub.\thevarSubSub.\thevarDeep.\thevarSubDeep\ - #2}%
    \ifx&#1&%
    \else\label{#1}\fi%
}

% 3. Contatore Secondario (es. UC-1.1)
\newcounter{ucSub}[ucMain]
\newcommand{\subusecase}[2]{%
    \refstepcounter{ucSub}%
    \setcounter{ucSubSub}{0}%
    \subsubsection*{UC-\theucMain.\theucSub\ - #2}%
    \addcontentsline{toc}{subsubsection}{UC-\theucMain.\theucSub\ - #2}%
    \ifx&#1&%
    \else\label{#1}\fi%
}

% 4. Contatore Terziario (es. UC-3.1.1)
\newcounter{ucSubSub}[ucSub]
\newcommand{\subsubusecase}[2]{%
    \refstepcounter{ucSubSub}%
    \setcounter{ucDeep}{0}%
    \paragraph*{UC-\theucMain.\theucSub.\theucSubSub\ - #2}%
    \addcontentsline{toc}{paragraph}{UC-\theucMain.\theucSub.\theucSubSub\ - #2}%
    \ifx&#1&%
    \else\label{#1}\fi%
}

% 5. Contatore Quaternario (es. UC-3.2.1.1)
\newcounter{ucDeep}[ucSubSub]
\newcommand{\deepusecase}[2]{%
    \refstepcounter{ucDeep}%
    \paragraph*{UC-\theucMain.\theucSub.\theucSubSub.\theucDeep\ - #2}%
    \addcontentsline{toc}{paragraph}{UC-\theucMain.\theucSub.\theucSubSub.\theucDeep\ - #2}%
    \ifx&#1&%
    \else\label{#1}\fi%
}

% 6. Contatore 5 (es. UC-3.2.1.1.5)
\newcounter{ucSubDeep}[ucSubSub]
\newcommand{\subdeepusecase}[2]{%
    \refstepcounter{ucSubDeep}%
    \paragraph*{UC-\theucMain.\theucSub.\theucSubSub.\theucDeep.\theucSubDeep\ - #2}%
    \addcontentsline{toc}{paragraph}{UC-\theucMain.\theucSub.\theucSubSub.\theucDeep.\theucSubDeep\ - #2}%
    \ifx&#1&%
    \else\label{#1}\fi%
}
% --- FINE DEFINIZIONE CONTATORI UC ---


\begin{document}
\pagenumbering{roman}

\pagenumbering{arabic}
\setcounter{page}{1}

\input{analisi/Abstract.tex}

\input{analisi/UC1.tex}
\input{analisi/UC2.tex}
\input{analisi/UC3.tex}
\input{analisi/UC4.tex}
\input{analisi/UC5-8.tex}
\input{analisi/UC10-13.tex}
\input{analisi/UC14-26.tex}
\input{analisi/UC27-42.tex}
\input{analisi/Requisiti.tex}
\end{document}